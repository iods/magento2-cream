<?xml version="1.0"?>
<!--
/**
 * Core module for extending and testing functionality across Magento 2
 *
 * @package   Iods_Core
 * @author    Rye Miller <rye@drkstr.dev>
 * @copyright Copyright (c) 2021, Rye Miller (https://ryemiller.io)
 * @license   See LICENSE for license details.
 */
-->
<csp_whitelist xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
               xsi:noNamespaceSchemaLocation="urn:magento:module:Magento_Csp/etc/csp_whitelist.xsd">

    <policies>
        <policy id="script-src">
            <values>
                <value id="cloudflare" type="host">*.cloudflare.com</value>
                <value id="twitter" type="host">*.twitter.com</value>
                <value id="fontawesome" type="host">*.fontawesome.com</value>
                <value id="google" type="host">*.google.com</value>
                <value id="google-analytics" type="host">www.google-analytics.com</value>
                <value id="google-tagmanager" type="host">www.googletagmanager.com</value>
                <value id="gstatic" type="host">*.gstatic.com</value>
                <value id="jsdelivr" type="host">*.jsdelivr.net</value>
                <value id="paypal" type="host">www.paypal.com</value>
                <value id="paypal-sandbox" type="host">www.sandbox.paypal.com</value>
            </values>
        </policy>
        <policy id="style-src">
            <values>
                <!-- @TODO add tailwind css here? -->
                <value id="cloudflare" type="host">*.cloudflare.com</value>
                <value id="fontawesome" type="host">*.fontawesome.com</value>
                <value id="maxcdn" type="host">*.bootstrapcdn.com</value>
            </values>
        </policy>
        <policy id="img-src">
            <values>
                <value id="cloudflare" type="host">*.cloudflare.com</value>
                <value id="google-analytics" type="host">www.google-analytics.com</value>
            </values>
        </policy>
        <policy id="connect-src">
            <values>
                <value id="cloudflare" type="host">*.cloudflare.com</value>
                <value id="google" type="host">*.google.com</value>
            </values>
        </policy>
        <policy id="font-src">
            <values>
                <!-- @TODO add Google fonts here? -->
                <value id="cloudflare" type="host">*.cloudflare.com</value>
                <value id="maxcdn" type="host">*.bootstrapcdn.com</value>
            </values>
        </policy>
    </policies>
</csp_whitelist>
